!function(e,t){var n,i,o,a,l=t.getElementById("width"),r=t.getElementById("container"),c=!1,d=parseInt(r.getAttribute("data-block-id"),10),s=new Image,u=t.getElementById("images"),m=d,g=t.getElementById("form"),h=function(){var e=t.documentElement.clientWidth||t.body.clientWidth;e<=0&&(e=960),l.value=e,r.style.width=e+"px"},p=function(){for(var e=t.getElementById("toolbar").getElementsByTagName("input"),n=0,i=e.length;n<i;++n)if(e[n].checked)return e[n].value;return"2980b9"},y=function(e){var n=t.createElement("input");return n.type="image",n.name="image",n.width="60",n.height="60",n.src=e,n},f=function(e){return"/image.php?id="+e+"&rnd="+(new Date).getTime()},E=function(){4===this.readyState&&this.status>=200&&this.status<400&&"OK"==this.responseText&&(a.src=f(o))},v=function(e){var t=new XMLHttpRequest;return t.open("POST","/click.php?ajax=1&id="+o,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.onreadystatechange=E,t.send("image.x="+n+"&image.y="+i+"&width="+l.value+"&color="+p()),t=null,e.preventDefault&&e.preventDefault(),!1},w=function(e){if("input"==e.target.tagName.toLowerCase()&&"image"==e.target.type.toLowerCase()){var l=t.documentElement.clientWidth||t.body.clientWidth;n=e.pageX,i=(e.pageY-40)%l,o=Math.floor((e.pageY-40)/l)+d,o>278&&(o-=278),a=e.target}},B=function(){u.insertBefore(y(s.src),u.firstChild),e.scrollTo(0,t.documentElement.clientWidth||t.body.clientWidth);var n=u.getElementsByTagName("input");n.length>3&&(u.removeChild(n[n.length-1]),m=m<=1?278:m-1),c=!1},b=function(){u.appendChild(y(s.src));var n=u.getElementsByTagName("input");n.length>3&&(u.removeChild(n[0]),d=d>=278?1:d+1,e.scrollBy(0,-(t.documentElement.clientWidth||t.body.clientWidth))),c=!1},T=function(t){e.history&&e.history.pushState&&e.history.pushState("","","/?id="+t)},I=function(){if(!c){var e=t.documentElement.scrollTop||t.body.scrollTop,n=r.clientHeight-(t.documentElement.clientHeight||t.body.clientHeight);e<=0?(c=!0,d=d<=1?278:d-1,s.onload=B,s.src=f(d),T(d)):e>=n-30&&(c=!0,m=m>=278?1:m+1,s.onload=b,s.src=f(m),T(m))}},W=function(){c=!0,m=m>=278?1:m+1,s.onload=b,s.src=f(m)};t.getElementById("page-up").style.display="none",t.getElementById("page-down").style.display="none",e.onresize=h,e.onscroll=I,r.onclick=w,g.onsubmit=v,h(),W()}(window,document);